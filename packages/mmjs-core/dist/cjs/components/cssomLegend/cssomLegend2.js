"use strict";const e=require("vue"),w=require("./const.js"),c=require("./methods.js"),B=require("./filters.js"),q=require("./legend-action.js"),M={class:"cssom_legend"},V={class:"cssom_legend__wrapper"},$={class:"cssom_legend__legend__wrap"},P=["onClick","onMouseenter","onMouseleave"],A=["src"],D=["viewBox"],F=["d"],O=["title"],W=e.defineComponent({__name:"cssomLegend",props:{ecInstance:{},eventName:{default:"rendered"}},setup(m){const u=e.inject(w.cssomLegendInjectKey,void 0),a=e.shallowRef(),r=e.ref(),{legendToggleSelect:E,highlight:y,downplay:S}=q.useLegendAction(a);function L(n,l){var o,i;const t=((o=r.value)==null?void 0:o.series)??[],s=t.at(l)??t.at(0);return s?(i=n==null?void 0:n.data)!=null&&i.length?B.normalizeLegendName({legend:n,serie:s,series:t}):B.normalizeLegendName({legend:n,serie:s,series:t}):[]}const N=e.computed(()=>{var n;return((n=r.value)==null?void 0:n.legend)??[]}),x=e.computed(()=>{var n;return((n=r.value)==null?void 0:n.color)??[]});function _(){r.value=this.getOption()}function z(n,l){var s;return{"--item-color":x.value[n],"--textStyle-color":(s=l==null?void 0:l.textStyle)==null?void 0:s.color}}function C(){var n;(n=a.value)==null||n.on(m.eventName,_)}function g(){var n;(n=a.value)==null||n.off(m.eventName,_)}return e.watchPostEffect(()=>{var n;a.value=m.ecInstance??((n=u==null?void 0:u.value)==null?void 0:n.ec),g(),C()}),e.onScopeDispose(()=>{g()}),(n,l)=>(e.openBlock(),e.createElementBlock("div",M,[e.createElementVNode("div",V,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(N.value,(t,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cssom_legend__legend",[`cssom_legend--box-${s}`]]),style:e.normalizeStyle(e.unref(c.getCustomLegendProperty)(t)),key:s},[e.createElementVNode("div",$,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(L(t,s),(o,i)=>{var d,v,f,p,h;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cssom_legend__legend_item",{"cssom_legend__legend_item--unselect":!e.unref(c.getSelectStatus)(t,o.name)}]),key:i,style:e.normalizeStyle(z(i,o)),onClick:k=>e.unref(E)(o.name),onMouseenter:k=>e.unref(y)(o.name),onMouseleave:k=>e.unref(S)(o.name)},[(d=o.icon??t.icon)!=null&&d.startsWith("image://")?(e.openBlock(),e.createElementBlock("img",{key:0,class:e.normalizeClass(["cssom_legend__image_icon",{"cssom_legend__image_icon--unselect":!e.unref(c.getSelectStatus)(t,o.name)}]),src:(v=o.icon??t.icon)==null?void 0:v.slice(8),alt:""},null,10,A)):(f=o.icon??t.icon)!=null&&f.startsWith("path://")?(e.openBlock(),e.createElementBlock("svg",{key:1,class:e.normalizeClass(["cssom_legend__svg_icon",{"cssom_legend__svg_icon--unselect":!e.unref(c.getSelectStatus)(t,o.name)}]),viewBox:e.unref(c.calculateViewBox)((p=o.icon??t.icon)==null?void 0:p.slice(7))},[e.createElementVNode("path",{d:(h=o.icon??t.icon)==null?void 0:h.slice(7)},null,8,F)],10,D)):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["cssom_legend__rect",[`legend-icon--${e.unref(c.getIconModified)(o.icon??t.icon)}`]])},null,2)),e.createElementVNode("div",{class:"cssom_legend__text",title:o.name},e.toDisplayString(e.unref(c.formatter)(t,o.name)),9,O)],46,P)}),128))])],6))),128))])]))}});module.exports=W;

"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("node:fs"),i=require("./options.cjs"),S=require("node:path"),C=require("node:fs/promises"),h=require("mime-types"),d={black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m",gray:"\x1B[90m",bgBlack:"\x1B[40m",bgRed:"\x1B[41m",bgGreen:"\x1B[42m",bgYellow:"\x1B[43m",bgBlue:"\x1B[44m",bgMagenta:"\x1B[45m",bgCyan:"\x1B[46m",bgWhite:"\x1B[47m",reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m"};function g(e,...t){return t.map(r=>d[r]).join("")+e+d.reset}function u(){return g(new Date().toLocaleTimeString(),"gray")+" "+g("[Mock]","cyan","bold")}let a="";const l={success(e){if(a!==e)return a=e,i.logLevelState.isLogSuccess&&console.log(`${u()}`,g(e,"green"))},info(e){if(a!==e)return a=e,i.logLevelState.isLogInfo&&console.log(`${u()}`,e)},wran(e){if(a!==e)return a=e,i.logLevelState.isLogWarn&&console.log(`${u()}`,g(e,"yellow"))},error(e){if(a!==e)return a=e,console.log(`${u()}`,g(e,"red"))}},T={success(e){l.success(e)},info(e){l.info(e)},wran(e){l.wran(e)},error(e){l.error(e)}};function x(e){try{const t=S.dirname(e);p.existsSync(t)||p.mkdirSync(t,{recursive:!0})}catch(t){l.error(t)}}function b(e,t,r,n=!0){x(e),p.writeFile(e,t,r,o=>{o?l.wran(o):n&&l.success(`ðŸ’§ Write File Successify ${e}`)})}async function $(e,t,r,n=!0){x(e);try{await C.appendFile(e,t,r),n&&l.success(`ðŸ’§ Append File Successify ${e}`)}catch(o){l.wran(o)}}function L(e){const t=e.match(/^(https?):\/\/([^\/:]+)(?::(\d+))?(\/.*)?$/i);if(!t)return"invalid_url";const r=t[1],n=t[2],o=t[3]||(r==="https"?"443":"80"),s=(t[4]||"").replace(/\//g,"_");let c=`${n}_${o}`;return s&&s!=="_"&&(c+=s),c.replace(/[^a-z0-9_]/gi,"_").replace(/_+/g,"_").toLowerCase()}function _(e){var c;let t=h.charset(e)||i.allowCharset[0];t=t.toLocaleLowerCase();let r=h.extension(e)||i.serverConfig.fileExt.slice(1),n=!((c=i.serverConfig.templateMimeType)!=null&&c.length)||i.serverConfig.templateMimeType.includes(r),o=i.serverConfig.fileExt,s=i.allowCharset.includes(t)?t:i.allowCharset[0];return n?s=i.allowCharset[0]:o=`.${r}`,{charset:t,encoding:s,isInnerTempType:n,fileExt:o,mimeType:r}}function F(e){return h.contentType(e)}function M(e,t){const n=t.replace(/^[\\/]|[\\/]$/g,"").replace(/\\/g,"/").replace(/\.[^/.]+$/,"").split("/"),o=[...e].sort((s,c)=>c.split(/[\\/]/).length-s.split(/[\\/]/).length);for(const s of o){const f=s.replace(/^[\\/]|[\\/]$/g,"").replace(/\\/g,"/").replace(/\.[^/.]+$/,"").split("/");if(f.length!==n.length)continue;let y=!0;for(let m=0;m<f.length;m++){const B=f[m],w=n[m];if(!/^\$[^/]+$/.test(B)&&B.toLowerCase()!==w.toLowerCase()){y=!1;break}}if(y)return s}return null}function v(e){try{return p.statSync(e),!0}catch{return!1}}exports.appendFileFn=$;exports.colorize=g;exports.existsSyncByMkdir=x;exports.fileExists=v;exports.findMatchingTemplatePath=M;exports.getContentTypeByPath=F;exports.logger=T;exports.non_write_loggger=l;exports.safeUrlToFilename=L;exports.useContentType=_;exports.writeMockFile=b;

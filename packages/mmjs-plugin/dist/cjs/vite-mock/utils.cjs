"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("node:fs"),n=require("./options.cjs"),S=require("node:path"),T=require("node:fs/promises"),y=require("mime-types"),d={black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m",gray:"\x1B[90m",bgBlack:"\x1B[40m",bgRed:"\x1B[41m",bgGreen:"\x1B[42m",bgYellow:"\x1B[43m",bgBlue:"\x1B[44m",bgMagenta:"\x1B[45m",bgCyan:"\x1B[46m",bgWhite:"\x1B[47m",reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m"};function g(e,...t){return t.map(r=>d[r]).join("")+e+d.reset}function u(){return g(new Date().toLocaleTimeString(),"gray")+" "+g("[Mock]","cyan","bold")}let a="";const l={success(e){if(a!==e)return a=e,n.logLevelState.isLogSuccess&&console.log(`${u()}`,g(e,"green"))},info(e){if(a!==e)return a=e,n.logLevelState.isLogInfo&&console.log(`${u()}`,e)},wran(e){if(a!==e)return a=e,n.logLevelState.isLogWarn&&console.log(`${u()}`,g(e,"yellow"))},error(e){if(a!==e)return a=e,console.log(`${u()}`,g(e,"red"))}},C={success(e){l.success(e)},info(e){l.info(e)},wran(e){l.wran(e)},error(e){l.error(e)}};function h(e){try{const t=S.dirname(e);p.existsSync(t)||p.mkdirSync(t,{recursive:!0})}catch(t){l.error(t)}}function b(e,t,r,o=!0){h(e),p.writeFile(e,t,r,s=>{s?l.wran(s):o&&l.success(`ðŸ’§ Write File Successify ${e}`)})}async function $(e,t,r,o=!0){h(e);try{await T.appendFile(e,t,r),o&&l.success(`ðŸ’§ Append File Successify ${e}`)}catch(s){l.wran(s)}}function L(e){const t=e.match(/^(https?):\/\/([^\/:]+)(?::(\d+))?(\/.*)?$/i);if(!t)return"invalid_url";const r=t[1],o=t[2],s=t[3]||(r==="https"?"443":"80"),i=(t[4]||"").replace(/\//g,"_");let c=`${o}_${s}`;return i&&i!=="_"&&(c+=i),c.replace(/[^a-z0-9_]/gi,"_").replace(/_+/g,"_").toLowerCase()}function M(e){var c;let t=y.charset(e)||n.allowCharset[0];t=t.toLocaleLowerCase();let r=y.extension(e)||n.customContentTypeToExt[e]||n.serverConfig.fileExt.slice(1),o=!((c=n.serverConfig.templateMimeType)!=null&&c.length)||n.serverConfig.templateMimeType.includes(r),s=n.serverConfig.fileExt,i=n.allowCharset.includes(t)?t:n.allowCharset[0];return o?i=n.allowCharset[0]:s=`.${r}`,{charset:t,encoding:i,isInnerTempType:o,fileExt:s,mimeType:r}}function _(e){return y.contentType(e)}function F(e,t){const o=t.replace(/^[\\/]|[\\/]$/g,"").replace(/\\/g,"/").replace(/\.[^/.]+$/,"").split("/"),s=[...e].sort((i,c)=>c.split(/[\\/]/).length-i.split(/[\\/]/).length);for(const i of s){const f=i.replace(/^[\\/]|[\\/]$/g,"").replace(/\\/g,"/").replace(/\.[^/.]+$/,"").split("/");if(f.length!==o.length)continue;let x=!0;for(let m=0;m<f.length;m++){const B=f[m],w=o[m];if(!/^\$[^/]+$/.test(B)&&B.toLowerCase()!==w.toLowerCase()){x=!1;break}}if(x)return i}return null}function v(e){try{return p.statSync(e),!0}catch{return!1}}function k(e){return e.method==="GET"?"accept":"content-type"}exports.appendFileFn=$;exports.colorize=g;exports.existsSyncByMkdir=h;exports.fileExists=v;exports.findMatchingTemplatePath=F;exports.getContentTypeByPath=_;exports.getHeaderMimeTypeKey=k;exports.logger=C;exports.non_write_loggger=l;exports.safeUrlToFilename=L;exports.useContentType=M;exports.writeMockFile=b;
